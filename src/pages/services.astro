---
import MarketingLayout from '../layouts/MarketingLayout.astro';
import ModernButton from '../components/ui/ModernButton.astro';
import ModernCard from '../components/ui/ModernCard.astro';
import ServiceCard from '../components/business/ServiceCard.astro';
import CaseStudyCard from '../components/business/CaseStudyCard.astro';
import TestimonialSlider from '../components/business/TestimonialSlider.astro';
import ContactForm from '../components/ContactForm.astro';
import ServicesQuiz from '../components/business/ServicesQuiz.tsx';
import { getCollection } from 'astro:content';
import { withBasePath } from '../utils/helpers';

const consultationHref = '#consultation';

const services = [
  {
    id: 'managed-it',
    title: 'Managed IT Services',
    description:
      'Reliable operations, responsive support, and a clear roadmap—so IT becomes predictable.',
    bullets: [
      '24/7 monitoring & alerting',
      'Helpdesk + onsite dispatch options',
      'Patch management & asset lifecycle',
      'Backup/DR testing and reporting',
    ],
  },
  {
    id: 'cybersecurity',
    title: 'Cybersecurity',
    description:
      'Reduce risk with layered controls, visibility, and response playbooks tailored to your environment.',
    bullets: [
      'Endpoint protection + hardening',
      'Email security & phishing defense',
      'MFA, SSO, identity governance',
      'Incident response guidance',
    ],
  },
  {
    id: 'cloud',
    title: 'Cloud Solutions',
    description:
      'Modernize safely: migrations, governance, cost optimization, and resilience by default.',
    bullets: [
      'Microsoft 365 / Google Workspace optimization',
      'Azure/AWS migrations & landing zones',
      'Network + access modernization',
      'Cost controls + policy guardrails',
    ],
  },
  {
    id: 'ai',
    title: 'AI Integration',
    description:
      'Adopt AI responsibly with guardrails, privacy protections, and measurable productivity gains.',
    bullets: [
      'AI readiness & data classification',
      'Workflow automation & copilots',
      'Policy, training, and governance',
      'Security reviews for AI tooling',
    ],
  },
];

const engagementModel = [
  {
    phase: 'Assess',
    outcomes: [
      'Environment inventory',
      'Risk baseline',
      'Quick-win action plan',
    ],
  },
  {
    phase: 'Onboard',
    outcomes: [
      'Monitoring & agent rollout',
      'Security hardening',
      'Runbooks + escalation',
    ],
  },
  {
    phase: 'Operate',
    outcomes: ['Helpdesk + ticketing', 'Patch cadence', 'Monthly reporting'],
  },
  {
    phase: 'Optimize',
    outcomes: [
      'Roadmap sessions',
      'Cost optimization',
      'Quarterly security review',
    ],
  },
];

const industries = [
  { name: 'Healthcare', note: 'HIPAA-aligned controls and audit support' },
  { name: 'Financial Services', note: 'SOC 2 readiness + vendor risk' },
  {
    name: 'Manufacturing',
    note: 'Operational continuity + endpoint resilience',
  },
  {
    name: 'Professional Services',
    note: 'Secure collaboration + identity governance',
  },
  { name: 'Retail', note: 'Device management + network segmentation' },
  { name: 'SaaS & Tech', note: 'Cloud guardrails + security program support' },
];

const caseStudies = (await getCollection('caseStudies' as never)) as any[];
const featuredCaseStudies = caseStudies.slice(0, 3);
const testimonials = (await getCollection('testimonials' as never)) as any[];
const featuredTestimonials = testimonials
  .filter(t => t?.data?.featured)
  .slice(0, 6);
---

<MarketingLayout
  title="Services | Apex Managed IT"
  description="Managed IT, cybersecurity, cloud, and AI services designed for reliability and risk reduction."
>
  <section class="relative overflow-hidden bg-zinc-950 pb-16 pt-28">
    <div
      class="absolute inset-0 -z-10 bg-[radial-gradient(circle_at_top,_rgba(0,102,255,0.16),_transparent_55%)]"
    >
    </div>
    <div class="mx-auto max-w-[1220px] px-6">
      <div class="grid gap-10 lg:grid-cols-2 lg:items-center">
        <div class="space-y-6">
          <p
            class="text-xs font-semibold uppercase tracking-[0.32em] text-zinc-400"
          >
            Services
          </p>
          <h1 class="text-4xl font-bold text-white sm:text-5xl">
            Clear, complete coverage for your
            <span class="text-accent-300"> IT and security.</span>
          </h1>
          <p class="max-w-2xl text-base text-zinc-300">
            We deliver the fundamentals (uptime, backups, patching, support) and
            the advanced layers (security, cloud modernization, AI adoption)
            with one accountable team.
          </p>
          <div class="flex flex-col gap-3 sm:flex-row">
            <ModernButton
              href={withBasePath('pricing/')}
              variant="secondary"
              className="min-h-[48px]"
            >
              View pricing
            </ModernButton>
            <ModernButton
              href={consultationHref}
              variant="primary"
              className="min-h-[48px]"
            >
              Schedule consultation
            </ModernButton>
          </div>
        </div>

        <div class="grid gap-4">
          <ModernCard
            variant="minimal"
            className="border-white/10 bg-zinc-950/60 p-6"
          >
            <p class="text-sm font-semibold text-white">Fast onboarding</p>
            <p class="mt-2 text-sm text-zinc-300">
              Most environments are fully monitored within 10–14 days (depending
              on size and complexity).
            </p>
          </ModernCard>
          <ModernCard
            variant="minimal"
            className="border-white/10 bg-zinc-950/60 p-6"
          >
            <p class="text-sm font-semibold text-white">
              Transparent reporting
            </p>
            <p class="mt-2 text-sm text-zinc-300">
              Monthly health reports and quarterly roadmap reviews—no mystery
              work.
            </p>
          </ModernCard>
        </div>
      </div>
    </div>
  </section>

  <section class="border-y border-white/5 bg-zinc-900/30">
    <div class="mx-auto max-w-[1220px] px-6 py-16">
      <div class="grid gap-5 md:grid-cols-2 lg:grid-cols-4">
        {
          services.map(s => (
            <ServiceCard
              title={s.title}
              description={s.description}
              bullets={s.bullets}
              href={`#${s.id}`}
            />
          ))
        }
      </div>
    </div>
  </section>

  {
    services.map(s => (
      <section id={s.id} class="bg-zinc-950">
        <div class="mx-auto max-w-[1220px] px-6 py-20">
          <div class="grid gap-10 lg:grid-cols-2 lg:items-start">
            <div class="space-y-4">
              <h2 class="text-3xl font-semibold text-white">{s.title}</h2>
              <p class="text-sm text-zinc-300">{s.description}</p>
              <div class="pt-2">
                <ModernButton
                  href={consultationHref}
                  variant="primary"
                  className="min-h-[48px]"
                >
                  Discuss your needs
                </ModernButton>
              </div>
            </div>
            <ModernCard
              variant="minimal"
              className="p-6 bg-zinc-950/60 border-white/10"
            >
              <p class="text-sm font-semibold text-white">What’s included</p>
              <ul class="mt-4 space-y-2 text-sm text-zinc-300">
                {s.bullets.map(item => (
                  <li class="flex items-start gap-2">
                    <span class="mt-2 h-1.5 w-1.5 flex-shrink-0 bg-accent-500" />
                    <span>{item}</span>
                  </li>
                ))}
              </ul>
              <p class="mt-5 text-xs text-zinc-400">
                Exact scope depends on your plan and environment. We’ll confirm
                inclusions during onboarding.
              </p>
            </ModernCard>
          </div>
        </div>
      </section>
    ))
  }

  <section class="border-y border-white/5 bg-zinc-900/30" id="engagement-model">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div class="max-w-3xl space-y-4">
        <h2 class="text-3xl font-semibold text-white">How we work</h2>
        <p class="text-sm text-zinc-300">
          A simple engagement model: assess risk, onboard cleanly, operate with
          discipline, and optimize continuously.
        </p>
      </div>

      <div class="mt-10 grid gap-5 md:grid-cols-2 lg:grid-cols-4">
        {
          engagementModel.map(step => (
            <ModernCard
              variant="minimal"
              className="p-6 bg-zinc-950/60 border-white/10"
            >
              <p class="text-sm font-semibold text-white">{step.phase}</p>
              <ul class="mt-4 space-y-2 text-sm text-zinc-300">
                {step.outcomes.map(outcome => (
                  <li class="flex items-start gap-2">
                    <span class="mt-2 h-1.5 w-1.5 flex-shrink-0 bg-accent-500" />
                    <span>{outcome}</span>
                  </li>
                ))}
              </ul>
            </ModernCard>
          ))
        }
      </div>
    </div>
  </section>

  <section class="bg-zinc-950" id="industries">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div class="max-w-3xl space-y-4">
        <h2 class="text-3xl font-semibold text-white">Industries we support</h2>
        <p class="text-sm text-zinc-300">
          We bring proven playbooks, documentation, and controls to regulated
          and fast-moving environments.
        </p>
      </div>

      <div class="mt-10 grid gap-5 md:grid-cols-2 lg:grid-cols-3">
        {
          industries.map(i => (
            <ModernCard
              variant="minimal"
              className="p-6 bg-zinc-950/60 border-white/10"
            >
              <p class="text-sm font-semibold text-white">{i.name}</p>
              <p class="mt-2 text-sm text-zinc-300">{i.note}</p>
            </ModernCard>
          ))
        }
      </div>
    </div>
  </section>

  <section class="border-y border-white/5 bg-zinc-900/30" id="case-studies">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div
        class="flex flex-col gap-6 md:flex-row md:items-end md:justify-between"
      >
        <div class="max-w-3xl space-y-3">
          <h2 class="text-3xl font-semibold text-white">Recent outcomes</h2>
          <p class="text-sm text-zinc-300">
            A few examples of modernization, security hardening, and automation
            delivered for real teams.
          </p>
        </div>
        <ModernButton
          href={withBasePath('pricing/')}
          variant="secondary"
          className="min-h-[48px]"
        >
          Compare plans
        </ModernButton>
      </div>

      <div class="mt-10 grid gap-5 md:grid-cols-3">
        {
          featuredCaseStudies.map((entry: any) => (
            <CaseStudyCard
              title={entry.data?.title ?? entry.slug}
              industry={entry.data?.industry}
              summary={entry.data?.summary}
              results={entry.data?.results}
              href={withBasePath('services/#case-studies')}
            />
          ))
        }
      </div>
    </div>
  </section>

  <section class="bg-zinc-950">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div class="grid gap-10 lg:grid-cols-[1.1fr_0.9fr] lg:items-start">
        <div class="space-y-4">
          <h2 class="text-3xl font-semibold text-white">
            Not sure what you need?
          </h2>
          <p class="text-sm text-zinc-300">
            Take a 60-second quiz and we’ll recommend a starting package.
          </p>
          <ModernButton
            href={consultationHref}
            variant="secondary"
            className="min-h-[48px]"
          >
            Or talk to an expert
          </ModernButton>
        </div>
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6">
          <ServicesQuiz client:visible />
        </div>
      </div>
    </div>
  </section>

  <section class="border-t border-white/5 bg-zinc-900/30" id="testimonials">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div class="max-w-3xl space-y-4">
        <h2 class="text-3xl font-semibold text-white">What clients say</h2>
        <p class="text-sm text-zinc-300">
          Trust is earned in the day-to-day: reliable support, clear reporting,
          and real risk reduction.
        </p>
      </div>

      <div class="mt-10">
        <TestimonialSlider testimonials={featuredTestimonials} />
      </div>
    </div>
  </section>

  <section class="bg-zinc-950" id="consultation">
    <div class="mx-auto max-w-[1220px] px-6 py-20">
      <div class="grid gap-10 lg:grid-cols-2 lg:items-start">
        <div class="space-y-4">
          <h2 class="text-3xl font-semibold text-white">
            Get a tailored recommendation
          </h2>
          <p class="text-sm text-zinc-300">
            Tell us a bit about your environment (users, devices, compliance
            needs) and we’ll follow up with a practical plan.
          </p>
        </div>
        <div class="rounded-2xl border border-white/10 bg-white/5 p-6">
          <ContactForm />
        </div>
      </div>
      <p class="mt-6 text-xs text-zinc-500">
        By submitting, you agree to be contacted about our services. We do not
        sell your data.
      </p>
    </div>
  </section>
</MarketingLayout>
