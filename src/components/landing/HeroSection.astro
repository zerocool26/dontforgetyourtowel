---
import { withBasePath } from '../../utils/helpers';
import HeroCanvas from '../ui/HeroCanvas.astro';
import ModernButton from '../ui/ModernButton.astro';

interface Props {
  /** Main headline text */
  headline: string;
  /** Supporting subheading text */
  subheading: string;
  /** Optional badge/chip text */
  badge?: string;
  /** Enable animated entrance */
  animated?: boolean;
  /** Optional primary CTA */
  primaryCta?: { label: string; href: string };
  /** Optional secondary CTA */
  secondaryCta?: { label: string; href: string };
  /** Show experimental hero controls */
  showControls?: boolean;
}

const {
  headline = 'Build experiences that feel alive, not templated.',
  subheading = 'This Astro stack can deliver cinematic interfaces, tactile interactions, and bold visual storytelling while staying fast, accessible, and production-safe.',
  badge = 'Creative systems, shipped fast',
  animated = true,
  primaryCta,
  secondaryCta,
  showControls = false,
} = Astro.props;

const animationClasses = animated ? 'animate-fade-in' : '';

const resolvedPrimaryCta =
  primaryCta ??
  ({ label: 'Explore services', href: withBasePath('services/') } as const);

const resolvedSecondaryCta =
  secondaryCta ??
  ({ label: 'Portfolio', href: withBasePath('about/') } as const);
---

<section class={`relative isolate overflow-hidden ${animationClasses}`}>
  <div
    class="mx-auto w-full max-w-6xl px-6 pb-12 pt-20 sm:px-10 sm:pb-16 sm:pt-24"
  >
    <div
      class="pointer-events-none mb-6 rounded-2xl border border-white/10 bg-[radial-gradient(circle_at_30%_25%,rgba(124,58,237,0.12),transparent_60%),radial-gradient(circle_at_70%_45%,rgba(34,211,238,0.1),transparent_60%)] p-3 sm:mb-10"
      aria-hidden="true"
    >
      <div
        class="h-0.5 w-full rounded-full bg-gradient-to-r from-accent-500/30 via-white/10 to-violet-500/30"
      >
      </div>
    </div>

    <div
      class="bg-space-950/40 relative overflow-hidden rounded-2xl border border-white/10"
      data-hero-canvas-shell
    >
      <div class="relative h-[46vh] max-h-[560px] min-h-[320px] sm:h-[54vh]">
        <HeroCanvas className="opacity-100" variant="neural" />

        <div class="pointer-events-none absolute inset-0">
          <div
            class="from-space-950/35 via-space-950/10 to-space-950/55 absolute inset-0 bg-gradient-to-b"
          >
          </div>
          <div
            class="absolute inset-0 bg-[radial-gradient(circle_at_30%_25%,rgba(124,58,237,0.26),transparent_58%),radial-gradient(circle_at_70%_45%,rgba(34,211,238,0.22),transparent_58%)]"
          >
          </div>
        </div>
      </div>
    </div>

    <div class="mt-6 grid gap-6 sm:mt-8">
      <div
        class="pointer-events-auto rounded-2xl border border-white/10 bg-black/35 p-6 backdrop-blur-xl sm:p-8"
      >
        <p
          class="inline-flex items-center gap-2 rounded-full border border-white/10 bg-white/5 px-4 py-2 font-mono text-xs tracking-wide text-slate-100"
        >
          <span
            class="h-2 w-2 rounded-full bg-accent-400 shadow-[0_0_20px_rgba(34,211,238,0.7)]"
            aria-hidden="true"></span>
          {badge}
        </p>

        <h1
          class="mt-6 text-balance text-4xl font-semibold tracking-tight text-white sm:text-6xl"
        >
          {headline}
        </h1>
        <p
          class="mt-5 max-w-2xl text-pretty text-base leading-relaxed text-slate-200 sm:text-lg"
        >
          {subheading}
        </p>

        <div
          class="mt-8 flex flex-col gap-3 sm:mt-9 sm:flex-row sm:flex-wrap sm:items-center"
        >
          <ModernButton href={resolvedPrimaryCta.href} variant="primary">
            {resolvedPrimaryCta.label}
          </ModernButton>
          <ModernButton href={resolvedSecondaryCta.href} variant="secondary">
            {resolvedSecondaryCta.label}
          </ModernButton>
          <a
            href={withBasePath('contact-hq/')}
            class="inline-flex min-h-[48px] items-center justify-center rounded-lg border border-white/10 bg-white/5 px-5 text-sm font-semibold text-zinc-200 transition hover:border-white/20 hover:text-white"
          >
            Contact HQ
          </a>
          {
            showControls ? (
              <button
                type="button"
                class="inline-flex items-center justify-center rounded-md border border-white/15 bg-white/5 px-6 py-3 font-semibold text-white transition hover:bg-white/10 focus:outline-none focus:ring-2 focus:ring-accent-300"
                data-hero-controls-toggle
                aria-expanded="false"
                aria-controls="hero-controls-panel"
              >
                Hero controls
              </button>
            ) : null
          }
        </div>

        <div class="mt-6 flex flex-wrap gap-2">
          <span
            class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] uppercase tracking-wide text-zinc-300"
          >
            Story-driven UI
          </span>
          <span
            class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] uppercase tracking-wide text-zinc-300"
          >
            Motion with intention
          </span>
          <span
            class="rounded-full border border-white/10 bg-white/5 px-3 py-1 text-[11px] uppercase tracking-wide text-zinc-300"
          >
            Static-first speed
          </span>
        </div>

        {
          showControls ? (
            <div
              id="hero-controls-panel"
              class="mt-5 hidden rounded-2xl border border-white/10 bg-black/25 p-4 backdrop-blur"
              data-hero-controls-panel
            >
              <div class="grid gap-4 sm:grid-cols-2 lg:grid-cols-4">
                <label class="grid gap-1 text-sm text-white/80">
                  Chapter
                  <select
                    class="rounded-md border border-white/15 bg-white/5 px-3 py-2 text-sm text-white"
                    data-hero-control="variant"
                  >
                    <option value="neural">Neural</option>
                    <option value="city">City</option>
                    <option value="storm">Storm</option>
                    <option value="aurora">Aurora</option>
                  </select>
                </label>
                <label class="grid gap-1 text-sm text-white/80">
                  Speed
                  <input
                    type="range"
                    aria-label="Speed"
                    min="0.25"
                    max="2"
                    step="0.05"
                    value="1"
                    data-hero-control="speed"
                  />
                </label>
                <label class="grid gap-1 text-sm text-white/80">
                  Zoom
                  <input
                    type="range"
                    aria-label="Zoom"
                    min="0"
                    max="1"
                    step="0.01"
                    value="0"
                    data-hero-control="zoom"
                  />
                </label>
                <label class="grid gap-1 text-sm text-white/80">
                  Tint
                  <input
                    type="color"
                    value="#22d3ee"
                    class="h-10 w-full rounded-md border border-white/15 bg-white/5 p-1"
                    aria-label="Tint"
                    data-hero-control="tint"
                  />
                </label>
              </div>
              <div class="mt-4 flex flex-wrap gap-3">
                <button
                  type="button"
                  class="inline-flex items-center justify-center rounded-md bg-white/10 px-4 py-2 text-sm font-semibold text-white transition hover:bg-white/15 focus:outline-none focus:ring-2 focus:ring-accent-300"
                  data-hero-control="reset"
                >
                  Reset
                </button>
                <p class="text-xs text-white/60 sm:self-center">
                  Tip: change chapter + speed/zoom/tint live.
                </p>
              </div>
            </div>
          ) : null
        }
      </div>
    </div>
  </div>
</section>

{
  showControls ? (
    <script>import '../../scripts/hero-canvas-controls';</script>
  ) : null
}
