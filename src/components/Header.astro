---
import { CONTACT_EMAIL, SITE_TITLE } from '../consts';
import { withBasePath } from '../utils/helpers';
import ThemeSelector from './ThemeSelector.astro';
import ModernButton from './ui/ModernButton.astro';

const homeHref = withBasePath('/');

const links = [
  { label: 'Services', href: withBasePath('services/') },
  { label: 'About', href: withBasePath('about/') },
];

const startProjectHref = `mailto:${encodeURIComponent(
  CONTACT_EMAIL
)}?subject=${encodeURIComponent('New project inquiry')}`;
---

<header
  class="safe-area-inset-top sticky top-0 z-50 border-b border-t-4 border-b-zinc-800 border-t-accent-500 bg-zinc-950/95 backdrop-blur-md"
>
  <nav
    class="mx-auto flex h-16 max-w-[1400px] items-center justify-between px-5 py-0 sm:px-6 lg:px-8"
    aria-label="Main navigation"
  >
    <a
      class="group flex h-full items-center gap-3 py-3 text-zinc-100"
      href={homeHref}
      aria-label={`${SITE_TITLE} home`}
    >
      <span
        class="inline-flex h-8 w-8 items-center justify-center border border-zinc-700 bg-zinc-900 text-[10px] font-bold uppercase tracking-widest text-zinc-100 transition-colors group-hover:border-accent-500 group-hover:text-accent-500"
      >
        OC
      </span>
      <div class="flex flex-col leading-none">
        <span
          class="font-display text-sm font-bold uppercase tracking-tight text-zinc-100"
        >
          {SITE_TITLE}
        </span>
        <span
          class="mt-0.5 font-mono text-[0.6rem] uppercase tracking-widest text-accent-500"
        >
          CONSULTING • SECURITY • CLOUD • ENGINEERING
        </span>
      </div>
    </a>

    <div class="hidden h-full items-center md:flex">
      <a
        class="flex h-full items-center border-l border-zinc-800/50 px-4 font-mono text-xs uppercase tracking-wide text-zinc-400 transition hover:bg-zinc-900 hover:text-white"
        href={homeHref}
      >
        Home
      </a>
      {
        links.map(link => (
          <a
            class={
              'flex h-full items-center border-l border-zinc-800/50 px-4 font-mono text-xs uppercase tracking-wide text-zinc-400 transition hover:bg-zinc-900 hover:text-white'
            }
            href={link.href}
          >
            {link.label}
          </a>
        ))
      }
      <div class="h-full w-px bg-zinc-800/50"></div>
    </div>

    <div class="hidden items-center gap-4 pl-6 md:flex">
      <ThemeSelector />
      <div class="h-6 w-px bg-zinc-800"></div>
      <ModernButton
        variant="primary"
        className="font-mono text-xs uppercase tracking-wider"
        rounded="sm"
        href={startProjectHref}
      >
        Start a Project
      </ModernButton>
    </div>

    <div class="md:hidden">
      <ModernButton
        variant="outline"
        className="min-h-touch min-w-touch flex h-12 w-12 touch-manipulation items-center justify-center border-zinc-800 bg-zinc-900 p-0 text-zinc-400 hover:border-zinc-600 hover:text-white"
        id="mobile-menu-button"
        type="button"
        aria-controls="mobile-menu"
        aria-expanded="false"
        rounded="none"
      >
        <span class="sr-only">Toggle navigation</span>
        <svg
          class="h-5 w-5"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            d="M4 7h16M4 12h16M4 17h16"
            stroke-linecap="square"
            stroke-linejoin="miter"
            stroke-width="1.5"></path>
        </svg>
      </ModernButton>
    </div>
  </nav>

  <div class="md:hidden" id="mobile-menu" hidden>
    <div
      class="space-y-2 border-t border-white/10 bg-[rgba(11,19,35,0.92)] px-4 py-5 text-sm"
    >
      <a
        class="min-h-touch flex touch-manipulation items-center rounded-lg px-3 py-3 font-medium text-slate-200 transition hover:bg-white/5"
        href={homeHref}
      >
        Home
      </a>
      {
        links.map(link => (
          <a
            class="min-h-touch flex touch-manipulation items-center rounded-lg px-3 py-3 font-medium text-slate-200 transition hover:bg-white/5"
            href={link.href}
          >
            {link.label}
          </a>
        ))
      }
      <a
        class="min-h-touch flex touch-manipulation items-center rounded-lg px-3 py-3 font-semibold text-slate-100 transition hover:bg-white/5"
        href={withBasePath('services/')}
      >
        View services
      </a>
      <a
        class="min-h-touch flex touch-manipulation items-center rounded-lg bg-[rgba(99,102,241,0.15)] px-3 py-3 font-semibold text-white transition hover:bg-[rgba(99,102,241,0.25)]"
        href={startProjectHref}
      >
        Start a project
      </a>
    </div>
  </div>
</header>

<script>
  // Import the enhanced header script that uses our utilities
  import '../scripts/header';
</script>
