---
export interface Props {
  variant?:
    | 'default'
    | 'outline'
    | 'gradient'
    | 'glass'
    | 'neon'
    | 'minimal'
    | 'elevated'
    | 'bordered';
  size?: 'xs' | 'sm' | 'md' | 'lg' | 'xl';
  className?: string;
  href?: string;
  hover?: boolean;
  glow?: boolean;
  spotlight?: boolean;
  animated?: boolean;
  direction?: 'up' | 'down' | 'left' | 'right';
  delay?: number;
  style?: string;
  [key: string]: any;
}

const {
  variant = 'default',
  size = 'md',
  className = '',
  href,
  hover = true,
  glow = false,
  spotlight = false,
  animated = false,
  direction = 'up',
  delay = 0,
  style = '',
  ...rest
} = Astro.props;

const baseClasses =
  'rounded-2xl transition-all duration-500 ease-smooth relative overflow-hidden group will-change-transform touch-manipulation';

const variants = {
  default:
    'glass-card bg-white dark:bg-neutral-800 border border-neutral-200 dark:border-neutral-700 shadow-lg backdrop-blur-sm',
  outline:
    'border-2 border-primary-200 dark:border-primary-700 bg-transparent backdrop-blur-md hover:bg-primary-50/50 dark:hover:bg-primary-900/20',
  gradient:
    'bg-gradient-to-br from-primary-50 via-white to-secondary-50 dark:from-primary-900/20 dark:via-neutral-800 dark:to-secondary-900/20 border border-primary-200 dark:border-primary-700 shadow-xl shadow-primary-500/10',
  glass:
    'glass-panel backdrop-blur-xl border border-white/30 dark:border-neutral-700/50 shadow-2xl shadow-black/10',
  neon: 'glow-strong bg-gradient-to-br from-cyan-50 to-blue-50 dark:from-cyan-900/20 dark:to-blue-900/20 border-2 border-cyan-400/50 shadow-xl shadow-cyan-500/30 hover:shadow-2xl hover:shadow-cyan-500/40',
  minimal:
    'bg-neutral-50 dark:bg-neutral-900 border border-neutral-100 dark:border-neutral-800 hover:shadow-md',
  elevated:
    'glass-card shadow-2xl shadow-black/20 hover:shadow-3xl hover:shadow-black/30 border border-white/20',
  bordered:
    'bg-white dark:bg-neutral-800 border-2 border-neutral-300 dark:border-neutral-600 hover:border-primary-400 dark:hover:border-primary-600',
};

const sizes = {
  xs: 'p-3',
  sm: 'p-4',
  md: 'p-6',
  lg: 'p-8',
  xl: 'p-10',
};

const hoverEffects = hover
  ? '[@media(hover:hover)]:hover:shadow-2xl [@media(hover:hover)]:hover:shadow-primary-500/20 [@media(hover:hover)]:hover:-translate-y-2 [@media(hover:hover)]:hover:scale-[1.02] [@media(hover:hover)]:hover:rotate-[0.5deg]'
  : '';
const glowEffects = glow
  ? 'before:absolute before:inset-0 before:rounded-2xl before:p-[2px] before:bg-gradient-to-r before:from-primary-500 before:via-secondary-500 before:to-accent-500 before:opacity-0 hover:before:opacity-100 before:transition-opacity before:duration-500 before:animate-gradient before:bg-[length:200%_200%]'
  : '';
const spotlightEffects = spotlight ? 'card-spotlight' : '';

const animationClasses = animated ? `animate-slide-${direction}` : '';
const delayStyle = delay > 0 ? `animation-delay: ${delay}s` : '';
const combinedStyle = [delayStyle, style].filter(Boolean).join('; ');

const interactiveClasses = href
  ? 'block cursor-pointer active:scale-[0.98] focus:outline-none focus:ring-2 focus:ring-accent-400/40 focus:ring-offset-2 focus:ring-offset-black/40'
  : '';

const classes = `${baseClasses} ${interactiveClasses} ${variants[variant]} ${sizes[size]} ${hoverEffects} ${glowEffects} ${spotlightEffects} ${animationClasses} ${className}`;

const Tag = href ? 'a' : 'div';
---

<Tag href={href} class={classes} style={combinedStyle} {...rest}>
  {/* Spotlight effect */}
  {
    spotlight && (
      <div
        class="pointer-events-none absolute inset-0 z-10 opacity-0 transition-opacity duration-500 group-hover:opacity-100"
        style="background: radial-gradient(600px circle at var(--mouse-x) var(--mouse-y), rgba(255,255,255,0.1), transparent 40%);"
      />
    )
  }

  {/* Glow effect background */}
  {
    glow && (
      <div class="absolute inset-[2px] z-10 rounded-2xl bg-white dark:bg-neutral-800" />
    )
  }

  {/* Content wrapper */}
  <div class="relative z-20">
    <slot />
  </div>

  {/* Animated background patterns */}
  {
    animated && (
      <>
        <div class="pointer-events-none absolute inset-0 opacity-0 transition-opacity duration-700 group-hover:opacity-100">
          <div class="bg-primary-500/10 absolute left-1/4 top-1/4 h-32 w-32 animate-float rounded-full blur-2xl" />
          <div
            class="bg-secondary-500/10 absolute bottom-1/4 right-1/4 h-24 w-24 animate-pulse-slow rounded-full blur-2xl"
            style="animation-delay: 1s"
          />
          <div
            class="absolute right-1/3 top-1/2 h-20 w-20 animate-float rounded-full bg-accent-500/10 blur-xl"
            style="animation-delay: 0.5s"
          />
        </div>
      </>
    )
  }

  {/* Hover shimmer effect */}
  <div
    class="pointer-events-none absolute inset-0 -translate-x-full bg-gradient-to-r from-transparent via-white/20 to-transparent transition-transform duration-1000 ease-out group-hover:translate-x-full"
  >
  </div>

  {/* Border glow for neon variant */}
  {
    variant === 'neon' && (
      <div class="absolute inset-0 animate-gradient rounded-2xl bg-gradient-to-r from-cyan-500/20 via-blue-500/20 to-purple-500/20 bg-[length:200%_200%] opacity-0 blur-md transition-opacity duration-500 group-hover:opacity-100" />
    )
  }

  {/* Grid pattern overlay */}
  {
    variant === 'glass' && (
      <div class="pointer-events-none absolute inset-0 opacity-[0.02] pattern-grid dark:opacity-[0.05]" />
    )
  }

  {/* Noise texture for depth */}
  <div
    class="pointer-events-none absolute inset-0 bg-noise opacity-[0.03] mix-blend-overlay dark:opacity-[0.08]"
  >
  </div>
</Tag>

<style>
  @media (max-width: 768px) {
    a {
      -webkit-tap-highlight-color: transparent;
    }
  }
</style>

<style>
  /* Enhanced animations */
  @keyframes slide-up {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-down {
    from {
      opacity: 0;
      transform: translateY(-20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  @keyframes slide-left {
    from {
      opacity: 0;
      transform: translateX(-20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  @keyframes slide-right {
    from {
      opacity: 0;
      transform: translateX(20px);
    }
    to {
      opacity: 1;
      transform: translateX(0);
    }
  }

  .animate-slide-up {
    animation: slide-up 0.6s ease-out both;
  }

  .animate-slide-down {
    animation: slide-down 0.6s ease-out both;
  }

  .animate-slide-left {
    animation: slide-left 0.6s ease-out both;
  }

  .animate-slide-right {
    animation: slide-right 0.6s ease-out both;
  }
</style>
