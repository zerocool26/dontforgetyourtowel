---
/**
 * Floating Demo Access Button
 * Provides quick access to the demo center from any page
 */

import { withBasePath } from '../../utils/helpers';
import ModernButton from './ModernButton.astro';

export interface Props {
  position?: 'bottom-right' | 'bottom-left' | 'top-right' | 'top-left';
  variant?: 'default' | 'minimal' | 'expanded';
  showOnScroll?: boolean;
}

const {
  position = 'bottom-right',
  variant = 'default',
  showOnScroll = true,
} = Astro.props;

const positionClasses = {
  'bottom-right': 'bottom-6 right-6',
  'bottom-left': 'bottom-6 left-6',
  'top-right': 'top-20 right-6',
  'top-left': 'top-20 left-6',
};
---

<div
  id="floating-demo-button"
  class={`fixed ${positionClasses[position]} z-40 ${showOnScroll ? 'translate-y-32 opacity-0' : ''} transition-all duration-500`}
>
  {
    variant === 'expanded' ? (
      <div class="flex flex-col gap-3">
        <ModernButton
          href={withBasePath('demo/')}
          variant="outline"
          className="group flex items-center gap-3 px-6 py-4 bg-zinc-900 border-zinc-800 text-zinc-100 shadow-lg hover:border-accent-500 hover:bg-zinc-900"
        >
          <span class="text-2xl">ðŸš€</span>
          <div class="flex flex-col items-start">
            <span class="font-mono text-sm font-bold text-accent-500">
              TRY DEMO
            </span>
            <span class="font-mono text-xs opacity-70">INTERACTIVE_MODE</span>
          </div>
        </ModernButton>
        <ModernButton
          href={withBasePath('demo/')}
          variant="ghost"
          className="flex items-center gap-3 px-6 py-3 bg-zinc-950/90 backdrop-blur-sm border border-zinc-800 text-zinc-400 hover:text-accent-500 hover:border-accent-500/50 hover:bg-zinc-900"
        >
          <span class="text-xl">ðŸŽ¨</span>
          <span class="font-mono text-sm font-semibold">VISUAL_TOUR</span>
        </ModernButton>
      </div>
    ) : variant === 'minimal' ? (
      <ModernButton
        href={withBasePath('demo/')}
        variant="outline"
        className="w-14 h-14 p-0 flex items-center justify-center bg-zinc-900 border-zinc-800 text-accent-500 shadow-lg hover:border-accent-500 hover:bg-zinc-800"
        title="Try Interactive Demo"
        aria-label="Try Interactive Demo"
      >
        <span class="text-2xl">ðŸš€</span>
      </ModernButton>
    ) : (
      <ModernButton
        href={withBasePath('demo/')}
        variant="outline"
        className="group flex items-center gap-3 px-5 py-3 bg-zinc-900 border-zinc-800 text-zinc-100 shadow-lg hover:border-accent-500 hover:bg-zinc-900 font-mono font-semibold"
      >
        <span class="text-xl text-accent-500">ðŸš€</span>
        <span>TRY_DEMO</span>
        <svg
          class="h-4 w-4 text-accent-500 transition-transform group-hover:translate-x-1"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 7l5 5m0 0l-5 5m5-5H6"
          />
        </svg>
      </ModernButton>
    )
  }
</div>

<script define:vars={{ showOnScroll }}>
  if (showOnScroll) {
    const button = document.getElementById('floating-demo-button');
    let hasShown = false;

    const handleScroll = () => {
      if (!button) return;

      const scrollPosition = window.scrollY;
      const shouldShow = scrollPosition > 300;

      if (shouldShow && !hasShown) {
        button.classList.remove('translate-y-32', 'opacity-0');
        button.classList.add('translate-y-0', 'opacity-100');
        hasShown = true;
      }
    };

    window.addEventListener('scroll', handleScroll, { passive: true });

    // Check initial position
    handleScroll();
  }
</script>

<style>
  @keyframes pulse-glow {
    0%,
    100% {
      box-shadow: 0 0 20px rgba(99, 102, 241, 0.5);
    }
    50% {
      box-shadow: 0 0 30px rgba(99, 102, 241, 0.8);
    }
  }

  #floating-demo-button a {
    animation: pulse-glow 2s ease-in-out infinite;
  }

  #floating-demo-button a:hover {
    animation: none;
  }
</style>
